import { Request, Response } from "express"; import { Document } from "../models/Document"; export const createDocument = async (req: Request, res: Response) => { try { if (!req.user?._id) { return res.status(401).send({ error: "User not authenticated" }); } const document = new Document({ ...req.body, userId: req.user._id }); await document.save(); res.status(201).send(document); } catch (error) { res.status(400).send(error); } }; export const getDocuments = async (req: Request, res: Response) => { try { if (!req.user?._id) { return res.status(401).send({ error: "User not authenticated" }); } const documents = await Document.find({ userId: req.user._id }); res.send(documents); } catch (error) { res.status(500).send(error); } }; export const getDocument = async (req: Request, res: Response) => { try { if (!req.user?._id) { return res.status(401).send({ error: "User not authenticated" }); } const document = await Document.findOne({ _id: req.params.id, userId: req.user._id }); if (!document) { return res.status(404).send(); } res.send(document); } catch (error) { res.status(500).send(error); } }; export const updateDocument = async (req: Request, res: Response) => { try { if (!req.user?._id) { return res.status(401).send({ error: "User not authenticated" }); } const document = await Document.findOneAndUpdate({ _id: req.params.id, userId: req.user._id }, req.body, { new: true }); if (!document) { return res.status(404).send(); } res.send(document); } catch (error) { res.status(400).send(error); } }; export const deleteDocument = async (req: Request, res: Response) => { try { if (!req.user?._id) { return res.status(401).send({ error: "User not authenticated" }); } const document = await Document.findOneAndDelete({ _id: req.params.id, userId: req.user._id }); if (!document) { return res.status(404).send(); } res.send(document); } catch (error) { res.status(500).send(error); } };
