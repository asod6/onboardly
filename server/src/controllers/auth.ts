import { Request, Response } from "express"; import jwt from "jsonwebtoken"; import { User } from "../models/User"; export const register = async (req: Request, res: Response) => { try { const { email, password, firstName, lastName, company } = req.body; const user = new User({ email, password, firstName, lastName, company }); await user.save(); const token = jwt.sign({ _id: user._id }, process.env.JWT_SECRET || "secret"); res.status(201).send({ user, token }); } catch (error) { res.status(400).send(error); } }; export const login = async (req: Request, res: Response) => { try { const { email, password } = req.body; const user = await User.findOne({ email }); if (!user || !(await user.comparePassword(password))) { throw new Error(); } const token = jwt.sign({ _id: user._id }, process.env.JWT_SECRET || "secret"); res.send({ user, token }); } catch (error) { res.status(400).send({ error: "Invalid login credentials" }); } };
